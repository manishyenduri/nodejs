{"ast":null,"code":"import axios from'axios';import{devURLTnega}from'../../utilities/config';import{POST_LOGIN,POST_LOGIN_ERROR,OTP_VERIFY,OTP_VERIFY_ERROR,LOGOUT_DATA,GET_USER,GET_ALL_MASTER_DATA,UPDATE_STATUS,VERIFY_OTP,VERIFY_OTP_ERROR,POST_FORGET,CHANGE_PASSWORD,CHANGE_PASSWORD_ERROR,POST_FORGET_ERROR,GET_BATCH_VERIFICATION}from'./types';import Swal from'sweetalert2';import withReactContent from'sweetalert2-react-content';var MySwal=withReactContent(Swal);var authtoken=localStorage.getItem('auth_token');console.log(localStorage.getItem('auth_token'));console.log(localStorage);export var loginApi=function loginApi(data){return function(dispatch){var API_URL=\"\".concat(devURLTnega,\"api/users/login\");var body={\"user\":{\"email\":data.email,\"password\":data.password}};axios.post(API_URL,body,{headers:{Authorization:'Bearer '+authtoken//localStorage.getItem('auth_token')\n}}).then(function(res){console.log(\"user data\",res);dispatch({type:POST_LOGIN,payload:res.data});dispatch({type:GET_USER,payload:res.data.user});}).catch(function(err){console.log(\"login--- \",err.response);// dispatch({type:POST_LOGIN_ERROR, payload:err.response.data})\n// MySwal.fire(err.response.data.message);\n// if(err.response.status == 401){\n//     const data ={\n//       refreshToken:localStorage.refresh_token\n//     }\n//     axios.post(`${devURLTnega}api/users/auth/token`,data)\n//     .then((res) => {\n//       localStorage.setItem('authorization',res.data.token)\n//       localStorage.setItem('refreshToken',res.data.refreshToken)  \n//     })\n//     .catch((err) => {\n//       const data={\n//         email: localStorage.getItem('email_id'),\n//         refreshToken:localStorage.getItem('refreshToken'),\n//       }\n//       axios.post('http://3.110.180.81:3000/api/users/logout',data)\n//       .then((res) => {\n//         localStorage.clear()\n//         dispatch({type:LOGOUT_DATA, payload:res})\n//       })\n//     })\n//   }\n// if(err.response.data.message==\"Login Failed\"){\n//     Swal.fire(\"Login\",\"Failed\",\"error\");\n// }\n});};};export var otpVerification=function otpVerification(data){return function(dispatch){var API_URL=\"\".concat(devURLTnega,\"api/users/verifyotp\");console.log('rflkfmlfkmlskmfk',data);axios.post(API_URL,data,{headers:{Authorization:'Bearer '+authtoken//localStorage.getItem('auth_token')\n}}).then(function(res){console.log(\"user data\",res.data);dispatch({type:OTP_VERIFY,payload:res.data});// localStorage.setItem('authorization',res.user.token)\n// localStorage.setItem('refreshToken',res.user.refreshtoken)\n}).catch(function(err){console.log(\"login--- \",err.response);dispatch({type:OTP_VERIFY_ERROR,payload:err});MySwal.fire(\"Invalid otp\");});};};export var forgotApi=function forgotApi(data){return function(dispatch){var API_URL=\"\".concat(devURLTnega,\"api/forgotpassword\");var body={\"email\":data.email};axios.post(API_URL,body,{headers:{Authorization:'Bearer '+authtoken//localStorage.getItem('auth_token')\n}}).then(function(res){console.log(res.data);dispatch({type:POST_FORGET,payload:res.data});}).catch(function(err){console.log(\"Forgot --- \",err.response);dispatch({type:POST_FORGET_ERROR,payload:err.response.data});if(err.response.status==401){var _data={refreshToken:localStorage.refresh_token};axios.post(\"\".concat(devURLTnega,\"api/users/auth/token\"),_data).then(function(res){localStorage.setItem('authorization',res.data.token);localStorage.setItem('refreshToken',res.data.refreshToken);});}if(err.response.data.message==\"Login Failed\"){Swal.fire(\"Login\",\"Failed\",\"error\");}});};};export var OtpVerified=function OtpVerified(data){return function(dispatch){console.log(data);var API_URL=\"\".concat(devURLTnega,\"api/users/verifyresetotp\");axios.post(API_URL,data,{headers:{Authorization:'Bearer '+authtoken//localStorage.getItem('auth_token')\n}}).then(function(res){console.log(res.data);dispatch({type:VERIFY_OTP,payload:res.data});}).catch(function(err){console.log(\"verified otp \",err.response);dispatch({type:VERIFY_OTP_ERROR,payload:err.response});if(err.response.status==401){var _data2={refreshToken:localStorage.refresh_token};axios.post(\"\".concat(devURLTnega,\"api/users/auth/token\"),_data2).then(function(res){localStorage.setItem('authorization',res.data.token);localStorage.setItem('refreshToken',res.data.refreshToken);});}if(err.response.data.message==\"Login Failed\"){Swal.fire(\"Login\",\"Failed\",\"error\");}});};};export var changePassword=function changePassword(data){return function(dispatch){console.log(data);var API_URL=\"\".concat(devURLTnega,\"api/users/changepassword\");axios.post(API_URL,data,{headers:{Authorization:'Bearer '+authtoken//localStorage.getItem('auth_token')\n}}).then(function(res){console.log(res.data);dispatch({type:CHANGE_PASSWORD,payload:res.data});}).catch(function(err){console.log(\"verified otp \",err.response);dispatch({type:CHANGE_PASSWORD_ERROR,payload:err.response});if(err.response.status==401){var _data3={refreshToken:localStorage.refresh_token};axios.post(\"\".concat(devURLTnega,\"api/users/auth/token\"),_data3).then(function(res){localStorage.setItem('authorization',res.data.token);localStorage.setItem('refreshToken',res.data.refreshToken);});}if(err.response.data.message==\"Login Failed\"){Swal.fire(\"Login\",\"Failed\",\"error\");}});};};//igr-batch-verification\nexport var getBatchVerification=function getBatchVerification(){return function(dispatch){var API_URL=\"\".concat(devURLTnega,\"api/dashboard/batchschema \");axios.get(API_URL,{headers:{Authorization:'Bearer '+authtoken}}).then(function(res){return res.data;}).then(function(response){console.log('200 - ',response);if(response.status==200){dispatch({type:GET_BATCH_VERIFICATION,payload:response});}}).catch(function(err){console.log(err.response);if(err.response.status==401){var data={refreshToken:localStorage.refresh_token};axios.post(\"\".concat(devURLTnega,\"api/users/auth/token\"),data).then(function(res){localStorage.setItem('authorization',res.data.token);localStorage.setItem('refreshToken',res.data.refreshToken);}).catch(function(err){var data={email:localStorage.getItem('email_id'),refreshToken:localStorage.getItem('refreshToken')};axios.post('http://3.110.180.81:3000/api/users/logout',data).then(function(res){localStorage.clear();dispatch({type:LOGOUT_DATA,payload:res});});});}if(err.response.data.message==\"Login Failed\"){Swal.fire(\"Login\",\"Failed\",\"error\");}});};};//ResetoPassword\nexport var resetPassword=function resetPassword(data){return function(dispatch){var API_URL=\"\".concat(devURLTnega,\"api/resetpassword\");var body={\"user\":{\"email\":data.email,\"password\":data.password,\"confirm_password\":data.confirm_password,// \"username\": data.name,\n\"role\":data.role,\"zone\":data.Zone,\"district\":data.District}};axios.post(API_URL,body,{headers:{Authorization:'Bearer '+authtoken//localStorage.getItem('auth_token')\n}}).then(function(res){console.log(\"user data\",res.data.user);dispatch({type:POST_LOGIN,payload:res.data});dispatch({type:GET_USER,payload:res.data.user});}).catch(function(err){console.log(\"login--- \",err.response);dispatch({type:POST_LOGIN_ERROR,payload:err.response.data});if(err.response.status==401){var _data4={refreshToken:localStorage.refresh_token};axios.post(\"\".concat(devURLTnega,\"api/users/auth/token\"),_data4).then(function(res){localStorage.setItem('authorization',res.data.token);localStorage.setItem('refreshToken',res.data.refreshToken);}).catch(function(err){var data={email:localStorage.getItem('email_id'),refreshToken:localStorage.getItem('refreshToken')};axios.post('http://3.110.180.81:3000/api/users/logout',data).then(function(res){localStorage.clear();dispatch({type:LOGOUT_DATA,payload:res});});});}if(err.response.data.message==\"Login Failed\"){Swal.fire(\"Login\",\"Failed\",\"error\");}});};};","map":{"version":3,"sources":["/home/user/Desktop/IGR/tnega-pratik/src/store/Login/action.js"],"names":["axios","devURLTnega","POST_LOGIN","POST_LOGIN_ERROR","OTP_VERIFY","OTP_VERIFY_ERROR","LOGOUT_DATA","GET_USER","GET_ALL_MASTER_DATA","UPDATE_STATUS","VERIFY_OTP","VERIFY_OTP_ERROR","POST_FORGET","CHANGE_PASSWORD","CHANGE_PASSWORD_ERROR","POST_FORGET_ERROR","GET_BATCH_VERIFICATION","Swal","withReactContent","MySwal","authtoken","localStorage","getItem","console","log","loginApi","data","dispatch","API_URL","body","email","password","post","headers","Authorization","then","res","type","payload","user","catch","err","response","otpVerification","fire","forgotApi","status","refreshToken","refresh_token","setItem","token","message","OtpVerified","changePassword","getBatchVerification","get","clear","resetPassword","confirm_password","role","Zone","District"],"mappings":"AAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,WAAT,KAA4B,wBAA5B,CACA,OAAQC,UAAR,CAAoBC,gBAApB,CAAsCC,UAAtC,CAAiDC,gBAAjD,CAAkEC,WAAlE,CAA+EC,QAA/E,CAAyFC,mBAAzF,CAA8GC,aAA9G,CAA4HC,UAA5H,CAAuIC,gBAAvI,CAAyJC,WAAzJ,CAAqKC,eAArK,CAAqLC,qBAArL,CAA6MC,iBAA7M,CAAgOC,sBAAhO,KAA6P,SAA7P,CACA,MAAOC,CAAAA,IAAP,KAAiB,aAAjB,CACA,MAAOC,CAAAA,gBAAP,KAA6B,2BAA7B,CACA,GAAMC,CAAAA,MAAM,CAAGD,gBAAgB,CAACD,IAAD,CAA/B,CAEA,GAAIG,CAAAA,SAAS,CAAGC,YAAY,CAACC,OAAb,CAAqB,YAArB,CAAhB,CACAC,OAAO,CAACC,GAAR,CAAYH,YAAY,CAACC,OAAb,CAAqB,YAArB,CAAZ,EACAC,OAAO,CAACC,GAAR,CAAYH,YAAZ,EAEA,MAAO,IAAMI,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAAAC,IAAI,QAAI,UAAAC,QAAQ,CAAG,CAEvC,GAAMC,CAAAA,OAAO,WAAM3B,WAAN,mBAAb,CAEA,GAAM4B,CAAAA,IAAI,CAAC,CACP,OAAQ,CACJ,QAASH,IAAI,CAACI,KADV,CAEJ,WAAYJ,IAAI,CAACK,QAFb,CADD,CAAX,CAOA/B,KAAK,CAACgC,IAAN,CAAWJ,OAAX,CAAmBC,IAAnB,CAAwB,CACpBI,OAAO,CAAE,CACPC,aAAa,CAAE,UAAYd,SAAW;AAD/B,CADW,CAAxB,EAKCe,IALD,CAKM,SAACC,GAAD,CAAO,CACTb,OAAO,CAACC,GAAR,CAAY,WAAZ,CAAyBY,GAAzB,EACAT,QAAQ,CAAC,CAACU,IAAI,CAACnC,UAAN,CAAkBoC,OAAO,CAACF,GAAG,CAACV,IAA9B,CAAD,CAAR,CACAC,QAAQ,CAAC,CAACU,IAAI,CAAC9B,QAAN,CAAiB+B,OAAO,CAACF,GAAG,CAACV,IAAJ,CAASa,IAAlC,CAAD,CAAR,CACH,CATD,EAUCC,KAVD,CAUO,SAAAC,GAAG,CAAE,CACRlB,OAAO,CAACC,GAAR,CAAY,WAAZ,CAAwBiB,GAAG,CAACC,QAA5B,EACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACH,CAxCD,EAyCH,CApD2B,EAArB,CAwDP,MAAO,IAAMC,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAAAjB,IAAI,QAAI,UAAAC,QAAQ,CAAG,CAE9C,GAAMC,CAAAA,OAAO,WAAM3B,WAAN,uBAAb,CACFsB,OAAO,CAACC,GAAR,CAAY,kBAAZ,CAA+BE,IAA/B,EACE1B,KAAK,CAACgC,IAAN,CAAWJ,OAAX,CAAmBF,IAAnB,CAAwB,CACpBO,OAAO,CAAE,CACPC,aAAa,CAAE,UAAYd,SAAW;AAD/B,CADW,CAAxB,EAKCe,IALD,CAKM,SAACC,GAAD,CAAO,CACTb,OAAO,CAACC,GAAR,CAAY,WAAZ,CAAyBY,GAAG,CAACV,IAA7B,EACAC,QAAQ,CAAC,CAACU,IAAI,CAACjC,UAAN,CAAkBkC,OAAO,CAACF,GAAG,CAACV,IAA9B,CAAD,CAAR,CACA;AACA;AACH,CAVD,EAWCc,KAXD,CAWO,SAAAC,GAAG,CAAE,CACRlB,OAAO,CAACC,GAAR,CAAY,WAAZ,CAAwBiB,GAAG,CAACC,QAA5B,EACAf,QAAQ,CAAC,CAACU,IAAI,CAAChC,gBAAN,CAAwBiC,OAAO,CAACG,GAAhC,CAAD,CAAR,CACAtB,MAAM,CAACyB,IAAP,CAAY,aAAZ,EAEH,CAhBD,EAiBH,CArBkC,EAA5B,CAuBP,MAAO,IAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAAAnB,IAAI,QAAI,UAAAC,QAAQ,CAAG,CAExC,GAAMC,CAAAA,OAAO,WAAM3B,WAAN,sBAAb,CAEA,GAAM4B,CAAAA,IAAI,CAAC,CAEH,QAASH,IAAI,CAACI,KAFX,CAAX,CAOA9B,KAAK,CAACgC,IAAN,CAAWJ,OAAX,CAAmBC,IAAnB,CAAwB,CACpBI,OAAO,CAAE,CACPC,aAAa,CAAE,UAAYd,SAAW;AAD/B,CADW,CAAxB,EAKCe,IALD,CAKM,SAACC,GAAD,CAAO,CACTb,OAAO,CAACC,GAAR,CAAYY,GAAG,CAACV,IAAhB,EAEAC,QAAQ,CAAC,CAACU,IAAI,CAACzB,WAAN,CAAmB0B,OAAO,CAACF,GAAG,CAACV,IAA/B,CAAD,CAAR,CAEH,CAVD,EAWCc,KAXD,CAWO,SAAAC,GAAG,CAAE,CACRlB,OAAO,CAACC,GAAR,CAAY,aAAZ,CAA0BiB,GAAG,CAACC,QAA9B,EACAf,QAAQ,CAAC,CAACU,IAAI,CAACtB,iBAAN,CAAyBuB,OAAO,CAACG,GAAG,CAACC,QAAJ,CAAahB,IAA9C,CAAD,CAAR,CACA,GAAGe,GAAG,CAACC,QAAJ,CAAaI,MAAb,EAAuB,GAA1B,CAA8B,CAE1B,GAAMpB,CAAAA,KAAI,CAAE,CACVqB,YAAY,CAAC1B,YAAY,CAAC2B,aADhB,CAAZ,CAGAhD,KAAK,CAACgC,IAAN,WAAc/B,WAAd,yBAAgDyB,KAAhD,EACCS,IADD,CACM,SAACC,GAAD,CAAS,CAEbf,YAAY,CAAC4B,OAAb,CAAqB,eAArB,CAAqCb,GAAG,CAACV,IAAJ,CAASwB,KAA9C,EACA7B,YAAY,CAAC4B,OAAb,CAAqB,cAArB,CAAoCb,GAAG,CAACV,IAAJ,CAASqB,YAA7C,EACD,CALD,EAMD,CACH,GAAGN,GAAG,CAACC,QAAJ,CAAahB,IAAb,CAAkByB,OAAlB,EAA2B,cAA9B,CAA6C,CACzClC,IAAI,CAAC2B,IAAL,CAAU,OAAV,CAAkB,QAAlB,CAA2B,OAA3B,EACH,CACJ,CA7BD,EA8BH,CAzC4B,EAAtB,CA4CP,MAAO,IAAMQ,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAAA1B,IAAI,QAAI,UAAAC,QAAQ,CAAG,CAE1CJ,OAAO,CAACC,GAAR,CAAYE,IAAZ,EAEA,GAAME,CAAAA,OAAO,WAAM3B,WAAN,4BAAb,CAGAD,KAAK,CAACgC,IAAN,CAAWJ,OAAX,CAAmBF,IAAnB,CAAwB,CACpBO,OAAO,CAAE,CACPC,aAAa,CAAE,UAAYd,SAAW;AAD/B,CADW,CAAxB,EAKCe,IALD,CAKM,SAACC,GAAD,CAAO,CACTb,OAAO,CAACC,GAAR,CAAYY,GAAG,CAACV,IAAhB,EAEAC,QAAQ,CAAC,CAACU,IAAI,CAAC3B,UAAN,CAAkB4B,OAAO,CAACF,GAAG,CAACV,IAA9B,CAAD,CAAR,CAEH,CAVD,EAWCc,KAXD,CAWO,SAAAC,GAAG,CAAE,CACRlB,OAAO,CAACC,GAAR,CAAY,eAAZ,CAA4BiB,GAAG,CAACC,QAAhC,EACAf,QAAQ,CAAC,CAACU,IAAI,CAAC1B,gBAAN,CAAwB2B,OAAO,CAACG,GAAG,CAACC,QAApC,CAAD,CAAR,CACA,GAAGD,GAAG,CAACC,QAAJ,CAAaI,MAAb,EAAuB,GAA1B,CAA8B,CAE1B,GAAMpB,CAAAA,MAAI,CAAE,CACVqB,YAAY,CAAC1B,YAAY,CAAC2B,aADhB,CAAZ,CAGAhD,KAAK,CAACgC,IAAN,WAAc/B,WAAd,yBAAgDyB,MAAhD,EACCS,IADD,CACM,SAACC,GAAD,CAAS,CAEbf,YAAY,CAAC4B,OAAb,CAAqB,eAArB,CAAqCb,GAAG,CAACV,IAAJ,CAASwB,KAA9C,EACA7B,YAAY,CAAC4B,OAAb,CAAqB,cAArB,CAAoCb,GAAG,CAACV,IAAJ,CAASqB,YAA7C,EACD,CALD,EAMD,CACH,GAAGN,GAAG,CAACC,QAAJ,CAAahB,IAAb,CAAkByB,OAAlB,EAA2B,cAA9B,CAA6C,CACzClC,IAAI,CAAC2B,IAAL,CAAU,OAAV,CAAkB,QAAlB,CAA2B,OAA3B,EACH,CACJ,CA7BD,EA8BH,CArC8B,EAAxB,CAuCP,MAAO,IAAMS,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAAA3B,IAAI,QAAI,UAAAC,QAAQ,CAAG,CAE7CJ,OAAO,CAACC,GAAR,CAAYE,IAAZ,EAEA,GAAME,CAAAA,OAAO,WAAM3B,WAAN,4BAAb,CAGAD,KAAK,CAACgC,IAAN,CAAWJ,OAAX,CAAmBF,IAAnB,CAAwB,CACpBO,OAAO,CAAE,CACPC,aAAa,CAAE,UAAYd,SAAW;AAD/B,CADW,CAAxB,EAKCe,IALD,CAKM,SAACC,GAAD,CAAO,CACTb,OAAO,CAACC,GAAR,CAAYY,GAAG,CAACV,IAAhB,EAEAC,QAAQ,CAAC,CAACU,IAAI,CAACxB,eAAN,CAAuByB,OAAO,CAACF,GAAG,CAACV,IAAnC,CAAD,CAAR,CAGH,CAXD,EAYCc,KAZD,CAYO,SAAAC,GAAG,CAAE,CACRlB,OAAO,CAACC,GAAR,CAAY,eAAZ,CAA4BiB,GAAG,CAACC,QAAhC,EACAf,QAAQ,CAAC,CAACU,IAAI,CAACvB,qBAAN,CAA6BwB,OAAO,CAACG,GAAG,CAACC,QAAzC,CAAD,CAAR,CACA,GAAGD,GAAG,CAACC,QAAJ,CAAaI,MAAb,EAAuB,GAA1B,CAA8B,CAE1B,GAAMpB,CAAAA,MAAI,CAAE,CACVqB,YAAY,CAAC1B,YAAY,CAAC2B,aADhB,CAAZ,CAGAhD,KAAK,CAACgC,IAAN,WAAc/B,WAAd,yBAAgDyB,MAAhD,EACCS,IADD,CACM,SAACC,GAAD,CAAS,CAEbf,YAAY,CAAC4B,OAAb,CAAqB,eAArB,CAAqCb,GAAG,CAACV,IAAJ,CAASwB,KAA9C,EACA7B,YAAY,CAAC4B,OAAb,CAAqB,cAArB,CAAoCb,GAAG,CAACV,IAAJ,CAASqB,YAA7C,EACD,CALD,EAMD,CACH,GAAGN,GAAG,CAACC,QAAJ,CAAahB,IAAb,CAAkByB,OAAlB,EAA2B,cAA9B,CAA6C,CACzClC,IAAI,CAAC2B,IAAL,CAAU,OAAV,CAAkB,QAAlB,CAA2B,OAA3B,EACH,CACJ,CA9BD,EA+BH,CAtCiC,EAA3B,CAyCP;AAEA,MAAO,IAAMU,CAAAA,oBAAoB,CAAE,QAAtBA,CAAAA,oBAAsB,SAAI,UAAC3B,QAAD,CAAY,CAC/C,GAAMC,CAAAA,OAAO,WAAI3B,WAAJ,8BAAb,CACAD,KAAK,CAACuD,GAAN,CAAU3B,OAAV,CAAkB,CACdK,OAAO,CAAC,CACJC,aAAa,CAAC,UAAWd,SADrB,CADM,CAAlB,EAIGe,IAJH,CAIQ,SAACC,GAAD,QAAOA,CAAAA,GAAG,CAACV,IAAX,EAJR,EAKCS,IALD,CAKM,SAACO,QAAD,CAAY,CACdnB,OAAO,CAACC,GAAR,CAAY,QAAZ,CAAqBkB,QAArB,EACA,GAAGA,QAAQ,CAACI,MAAT,EAAiB,GAApB,CAAwB,CACpBnB,QAAQ,CAAC,CAACU,IAAI,CAACrB,sBAAN,CAA8BsB,OAAO,CAACI,QAAtC,CAAD,CAAR,CACP,CACA,CAVD,EAWCF,KAXD,CAWO,SAAAC,GAAG,CAAE,CACRlB,OAAO,CAACC,GAAR,CAAYiB,GAAG,CAACC,QAAhB,EACA,GAAGD,GAAG,CAACC,QAAJ,CAAaI,MAAb,EAAuB,GAA1B,CAA8B,CAE1B,GAAMpB,CAAAA,IAAI,CAAE,CACVqB,YAAY,CAAC1B,YAAY,CAAC2B,aADhB,CAAZ,CAGAhD,KAAK,CAACgC,IAAN,WAAc/B,WAAd,yBAAgDyB,IAAhD,EACCS,IADD,CACM,SAACC,GAAD,CAAS,CAEbf,YAAY,CAAC4B,OAAb,CAAqB,eAArB,CAAqCb,GAAG,CAACV,IAAJ,CAASwB,KAA9C,EACA7B,YAAY,CAAC4B,OAAb,CAAqB,cAArB,CAAoCb,GAAG,CAACV,IAAJ,CAASqB,YAA7C,EACD,CALD,EAMCP,KAND,CAMO,SAACC,GAAD,CAAS,CACd,GAAMf,CAAAA,IAAI,CAAC,CACTI,KAAK,CAAET,YAAY,CAACC,OAAb,CAAqB,UAArB,CADE,CAETyB,YAAY,CAAC1B,YAAY,CAACC,OAAb,CAAqB,cAArB,CAFJ,CAAX,CAIAtB,KAAK,CAACgC,IAAN,CAAW,2CAAX,CAAuDN,IAAvD,EACCS,IADD,CACM,SAACC,GAAD,CAAS,CACbf,YAAY,CAACmC,KAAb,GACA7B,QAAQ,CAAC,CAACU,IAAI,CAAC/B,WAAN,CAAmBgC,OAAO,CAACF,GAA3B,CAAD,CAAR,CACD,CAJD,EAKD,CAhBD,EAiBD,CACH,GAAGK,GAAG,CAACC,QAAJ,CAAahB,IAAb,CAAkByB,OAAlB,EAA2B,cAA9B,CAA6C,CACzClC,IAAI,CAAC2B,IAAL,CAAU,OAAV,CAAkB,QAAlB,CAA2B,OAA3B,EACH,CACJ,CAvCD,EAwCH,CA1CkC,EAA5B,CA6CP;AAEA,MAAO,IAAMa,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAAA/B,IAAI,QAAI,UAAAC,QAAQ,CAAG,CAE5C,GAAMC,CAAAA,OAAO,WAAM3B,WAAN,qBAAb,CAEA,GAAM4B,CAAAA,IAAI,CAAC,CACP,OAAQ,CACJ,QAASH,IAAI,CAACI,KADV,CAEJ,WAAYJ,IAAI,CAACK,QAFb,CAGJ,mBAAoBL,IAAI,CAACgC,gBAHrB,CAIJ;AAEA,OAAQhC,IAAI,CAACiC,IANT,CAOJ,OAAQjC,IAAI,CAACkC,IAPT,CAQJ,WAAYlC,IAAI,CAACmC,QARb,CADD,CAAX,CAcA7D,KAAK,CAACgC,IAAN,CAAWJ,OAAX,CAAmBC,IAAnB,CAAwB,CACpBI,OAAO,CAAE,CACPC,aAAa,CAAE,UAAYd,SAAW;AAD/B,CADW,CAAxB,EAKCe,IALD,CAKM,SAACC,GAAD,CAAO,CACTb,OAAO,CAACC,GAAR,CAAY,WAAZ,CAAyBY,GAAG,CAACV,IAAJ,CAASa,IAAlC,EACAZ,QAAQ,CAAC,CAACU,IAAI,CAACnC,UAAN,CAAkBoC,OAAO,CAACF,GAAG,CAACV,IAA9B,CAAD,CAAR,CACAC,QAAQ,CAAC,CAACU,IAAI,CAAC9B,QAAN,CAAiB+B,OAAO,CAACF,GAAG,CAACV,IAAJ,CAASa,IAAlC,CAAD,CAAR,CACH,CATD,EAUCC,KAVD,CAUO,SAAAC,GAAG,CAAE,CACRlB,OAAO,CAACC,GAAR,CAAY,WAAZ,CAAwBiB,GAAG,CAACC,QAA5B,EACAf,QAAQ,CAAC,CAACU,IAAI,CAAClC,gBAAN,CAAwBmC,OAAO,CAACG,GAAG,CAACC,QAAJ,CAAahB,IAA7C,CAAD,CAAR,CACA,GAAGe,GAAG,CAACC,QAAJ,CAAaI,MAAb,EAAuB,GAA1B,CAA8B,CAE1B,GAAMpB,CAAAA,MAAI,CAAE,CACVqB,YAAY,CAAC1B,YAAY,CAAC2B,aADhB,CAAZ,CAGAhD,KAAK,CAACgC,IAAN,WAAc/B,WAAd,yBAAgDyB,MAAhD,EACCS,IADD,CACM,SAACC,GAAD,CAAS,CAEbf,YAAY,CAAC4B,OAAb,CAAqB,eAArB,CAAqCb,GAAG,CAACV,IAAJ,CAASwB,KAA9C,EACA7B,YAAY,CAAC4B,OAAb,CAAqB,cAArB,CAAoCb,GAAG,CAACV,IAAJ,CAASqB,YAA7C,EACD,CALD,EAMCP,KAND,CAMO,SAACC,GAAD,CAAS,CACd,GAAMf,CAAAA,IAAI,CAAC,CACTI,KAAK,CAAET,YAAY,CAACC,OAAb,CAAqB,UAArB,CADE,CAETyB,YAAY,CAAC1B,YAAY,CAACC,OAAb,CAAqB,cAArB,CAFJ,CAAX,CAIAtB,KAAK,CAACgC,IAAN,CAAW,2CAAX,CAAuDN,IAAvD,EACCS,IADD,CACM,SAACC,GAAD,CAAS,CACbf,YAAY,CAACmC,KAAb,GACA7B,QAAQ,CAAC,CAACU,IAAI,CAAC/B,WAAN,CAAmBgC,OAAO,CAACF,GAA3B,CAAD,CAAR,CACD,CAJD,EAKD,CAhBD,EAiBD,CACH,GAAGK,GAAG,CAACC,QAAJ,CAAahB,IAAb,CAAkByB,OAAlB,EAA2B,cAA9B,CAA6C,CACzClC,IAAI,CAAC2B,IAAL,CAAU,OAAV,CAAkB,QAAlB,CAA2B,OAA3B,EACH,CACJ,CAvCD,EAwCH,CA1DgC,EAA1B","sourcesContent":["import axios from 'axios';\r\nimport { devURLTnega } from '../../utilities/config';\r\nimport {POST_LOGIN, POST_LOGIN_ERROR ,OTP_VERIFY,OTP_VERIFY_ERROR,LOGOUT_DATA, GET_USER, GET_ALL_MASTER_DATA, UPDATE_STATUS,VERIFY_OTP,VERIFY_OTP_ERROR, POST_FORGET,CHANGE_PASSWORD,CHANGE_PASSWORD_ERROR , POST_FORGET_ERROR, GET_BATCH_VERIFICATION} from './types';\r\nimport Swal from 'sweetalert2';\r\nimport withReactContent from 'sweetalert2-react-content';\r\nconst MySwal = withReactContent(Swal);\r\n\r\nlet authtoken = localStorage.getItem('auth_token')\r\nconsole.log(localStorage.getItem('auth_token'))\r\nconsole.log(localStorage)\r\n\r\nexport const loginApi = data => dispatch =>{\r\n\r\n    const API_URL = `${devURLTnega}api/users/login`;\r\n\r\n    const body={\r\n        \"user\": {\r\n            \"email\": data.email,\r\n            \"password\": data.password,            \r\n        }\r\n    };\r\n\r\n    axios.post(API_URL,body,{\r\n        headers: {\r\n          Authorization: 'Bearer ' + authtoken, //localStorage.getItem('auth_token')\r\n        },\r\n      })\r\n    .then((res)=>{\r\n        console.log(\"user data\", res);\r\n        dispatch({type:POST_LOGIN, payload:res.data})\r\n        dispatch({type:GET_USER , payload:res.data.user})\r\n    })\r\n    .catch(err=>{\r\n        console.log(\"login--- \",err.response);\r\n        // dispatch({type:POST_LOGIN_ERROR, payload:err.response.data})\r\n        // MySwal.fire(err.response.data.message);\r\n        // if(err.response.status == 401){\r\n\r\n        //     const data ={\r\n        //       refreshToken:localStorage.refresh_token\r\n        //     }\r\n        //     axios.post(`${devURLTnega}api/users/auth/token`,data)\r\n        //     .then((res) => {\r\n              \r\n        //       localStorage.setItem('authorization',res.data.token)\r\n        //       localStorage.setItem('refreshToken',res.data.refreshToken)  \r\n        //     })\r\n        //     .catch((err) => {\r\n        //       const data={\r\n        //         email: localStorage.getItem('email_id'),\r\n        //         refreshToken:localStorage.getItem('refreshToken'),\r\n        //       }\r\n        //       axios.post('http://3.110.180.81:3000/api/users/logout',data)\r\n        //       .then((res) => {\r\n        //         localStorage.clear()\r\n        //         dispatch({type:LOGOUT_DATA, payload:res})\r\n        //       })\r\n        //     })\r\n        //   }\r\n        // if(err.response.data.message==\"Login Failed\"){\r\n        //     Swal.fire(\"Login\",\"Failed\",\"error\");\r\n        // }\r\n    })\r\n}\r\n\r\n\r\n\r\nexport const otpVerification = data => dispatch =>{\r\n\r\n    const API_URL = `${devURLTnega}api/users/verifyotp`;\r\n  console.log('rflkfmlfkmlskmfk',data)\r\n    axios.post(API_URL,data,{\r\n        headers: {\r\n          Authorization: 'Bearer ' + authtoken, //localStorage.getItem('auth_token')\r\n        },\r\n      })\r\n    .then((res)=>{\r\n        console.log(\"user data\", res.data);        \r\n        dispatch({type:OTP_VERIFY, payload:res.data})\r\n        // localStorage.setItem('authorization',res.user.token)\r\n        // localStorage.setItem('refreshToken',res.user.refreshtoken)\r\n    })\r\n    .catch(err=>{\r\n        console.log(\"login--- \",err.response);\r\n        dispatch({type:OTP_VERIFY_ERROR, payload:err})\r\n        MySwal.fire(\"Invalid otp\")\r\n        \r\n    })\r\n}\r\n\r\nexport const forgotApi = data => dispatch =>{\r\n\r\n    const API_URL = `${devURLTnega}api/forgotpassword`;\r\n\r\n    const body={\r\n    \r\n            \"email\": data.email\r\n           \r\n        \r\n    };\r\n\r\n    axios.post(API_URL,body,{\r\n        headers: {\r\n          Authorization: 'Bearer ' + authtoken, //localStorage.getItem('auth_token')\r\n        },\r\n      })\r\n    .then((res)=>{\r\n        console.log(res.data);\r\n\r\n        dispatch({type:POST_FORGET, payload:res.data})\r\n        \r\n    })\r\n    .catch(err=>{\r\n        console.log(\"Forgot --- \",err.response);\r\n        dispatch({type:POST_FORGET_ERROR, payload:err.response.data})\r\n        if(err.response.status == 401){\r\n\r\n            const data ={\r\n              refreshToken:localStorage.refresh_token\r\n            }\r\n            axios.post(`${devURLTnega}api/users/auth/token`,data)\r\n            .then((res) => {\r\n              \r\n              localStorage.setItem('authorization',res.data.token)\r\n              localStorage.setItem('refreshToken',res.data.refreshToken)  \r\n            })\r\n          }\r\n        if(err.response.data.message==\"Login Failed\"){\r\n            Swal.fire(\"Login\",\"Failed\",\"error\");\r\n        }\r\n    })\r\n}\r\n\r\n\r\nexport const OtpVerified = data => dispatch =>{\r\n\r\n    console.log(data);\r\n\r\n    const API_URL = `${devURLTnega}api/users/verifyresetotp`;\r\n\r\n    \r\n    axios.post(API_URL,data,{\r\n        headers: {\r\n          Authorization: 'Bearer ' + authtoken, //localStorage.getItem('auth_token')\r\n        },\r\n      })\r\n    .then((res)=>{\r\n        console.log(res.data);\r\n\r\n        dispatch({type:VERIFY_OTP, payload:res.data})\r\n        \r\n    })\r\n    .catch(err=>{\r\n        console.log(\"verified otp \",err.response);\r\n        dispatch({type:VERIFY_OTP_ERROR, payload:err.response})\r\n        if(err.response.status == 401){\r\n\r\n            const data ={\r\n              refreshToken:localStorage.refresh_token\r\n            }\r\n            axios.post(`${devURLTnega}api/users/auth/token`,data)\r\n            .then((res) => {\r\n              \r\n              localStorage.setItem('authorization',res.data.token)\r\n              localStorage.setItem('refreshToken',res.data.refreshToken)  \r\n            })\r\n          }\r\n        if(err.response.data.message==\"Login Failed\"){\r\n            Swal.fire(\"Login\",\"Failed\",\"error\");\r\n        }\r\n    })\r\n}\r\n\r\nexport const changePassword = data => dispatch =>{\r\n\r\n    console.log(data);\r\n\r\n    const API_URL = `${devURLTnega}api/users/changepassword`;\r\n\r\n    \r\n    axios.post(API_URL,data,{\r\n        headers: {\r\n          Authorization: 'Bearer ' + authtoken, //localStorage.getItem('auth_token')\r\n        },\r\n      })\r\n    .then((res)=>{\r\n        console.log(res.data);\r\n\r\n        dispatch({type:CHANGE_PASSWORD, payload:res.data})\r\n\r\n        \r\n    })\r\n    .catch(err=>{\r\n        console.log(\"verified otp \",err.response);\r\n        dispatch({type:CHANGE_PASSWORD_ERROR, payload:err.response})\r\n        if(err.response.status == 401){\r\n\r\n            const data ={\r\n              refreshToken:localStorage.refresh_token\r\n            }\r\n            axios.post(`${devURLTnega}api/users/auth/token`,data)\r\n            .then((res) => {\r\n              \r\n              localStorage.setItem('authorization',res.data.token)\r\n              localStorage.setItem('refreshToken',res.data.refreshToken)  \r\n            })\r\n          }\r\n        if(err.response.data.message==\"Login Failed\"){\r\n            Swal.fire(\"Login\",\"Failed\",\"error\");\r\n        }\r\n    })\r\n}\r\n\r\n\r\n//igr-batch-verification\r\n\r\nexport const getBatchVerification =()=>(dispatch)=>{\r\n    const API_URL=`${devURLTnega}api/dashboard/batchschema `;\r\n    axios.get(API_URL,{\r\n        headers:{\r\n            Authorization:'Bearer '+ authtoken\r\n        }\r\n    }).then((res)=>res.data)\r\n    .then((response)=>{\r\n        console.log('200 - ',response)\r\n        if(response.status==200){\r\n            dispatch({type:GET_BATCH_VERIFICATION, payload:response})\r\n    }\r\n    })\r\n    .catch(err=>{\r\n        console.log(err.response);\r\n        if(err.response.status == 401){\r\n\r\n            const data ={\r\n              refreshToken:localStorage.refresh_token\r\n            }\r\n            axios.post(`${devURLTnega}api/users/auth/token`,data)\r\n            .then((res) => {\r\n              \r\n              localStorage.setItem('authorization',res.data.token)\r\n              localStorage.setItem('refreshToken',res.data.refreshToken)  \r\n            })\r\n            .catch((err) => {\r\n              const data={\r\n                email: localStorage.getItem('email_id'),\r\n                refreshToken:localStorage.getItem('refreshToken'),\r\n              }\r\n              axios.post('http://3.110.180.81:3000/api/users/logout',data)\r\n              .then((res) => {\r\n                localStorage.clear()\r\n                dispatch({type:LOGOUT_DATA, payload:res})\r\n              })\r\n            })\r\n          }\r\n        if(err.response.data.message==\"Login Failed\"){\r\n            Swal.fire(\"Login\",\"Failed\",\"error\");\r\n        }\r\n    })\r\n}\r\n\r\n\r\n//ResetoPassword\r\n\r\nexport const resetPassword = data => dispatch =>{\r\n\r\n    const API_URL = `${devURLTnega}api/resetpassword`;\r\n\r\n    const body={\r\n        \"user\": {\r\n            \"email\": data.email,\r\n            \"password\": data.password,\r\n            \"confirm_password\": data.confirm_password,\r\n            // \"username\": data.name,\r\n            \r\n            \"role\": data.role,\r\n            \"zone\": data.Zone,\r\n            \"district\": data.District\r\n            \r\n        }\r\n    };\r\n\r\n    axios.post(API_URL,body,{\r\n        headers: {\r\n          Authorization: 'Bearer ' + authtoken, //localStorage.getItem('auth_token')\r\n        },\r\n      })\r\n    .then((res)=>{\r\n        console.log(\"user data\", res.data.user);\r\n        dispatch({type:POST_LOGIN, payload:res.data})\r\n        dispatch({type:GET_USER , payload:res.data.user})\r\n    })\r\n    .catch(err=>{\r\n        console.log(\"login--- \",err.response);\r\n        dispatch({type:POST_LOGIN_ERROR, payload:err.response.data})\r\n        if(err.response.status == 401){\r\n\r\n            const data ={\r\n              refreshToken:localStorage.refresh_token\r\n            }\r\n            axios.post(`${devURLTnega}api/users/auth/token`,data)\r\n            .then((res) => {\r\n              \r\n              localStorage.setItem('authorization',res.data.token)\r\n              localStorage.setItem('refreshToken',res.data.refreshToken)  \r\n            })\r\n            .catch((err) => {\r\n              const data={\r\n                email: localStorage.getItem('email_id'),\r\n                refreshToken:localStorage.getItem('refreshToken'),\r\n              }\r\n              axios.post('http://3.110.180.81:3000/api/users/logout',data)\r\n              .then((res) => {\r\n                localStorage.clear()\r\n                dispatch({type:LOGOUT_DATA, payload:res})\r\n              })\r\n            })\r\n          }\r\n        if(err.response.data.message==\"Login Failed\"){\r\n            Swal.fire(\"Login\",\"Failed\",\"error\");\r\n        }\r\n    })\r\n}\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}